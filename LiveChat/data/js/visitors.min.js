function updateVisitors(){var t,e,s,a=sessionStorage.getItem("ultimate_support_chat-jsSession--loggedUsersResults"),i=JSON.parse(a);if(void 0!=i.tracked_users)if(0==i.tracked_users.length)$("#online-visitors-container").html("");else{$("#online-visitors-container").html('<div class="row"><div class="col-xs-12"><div class="panel"><header class="panel-heading">Online Visitors</header><div class="panel-body table-responsive"><div class="box-tools m-b-15"><div class="input-group"><input type="text" name="table_search" class="form-control input-sm pull-right" style="width: 150px;" placeholder="Search"/><div class="input-group-btn"><button class="btn btn-sm btn-default"><i class="fa fa-search"></i></button></div></div></div><table id="visitors_table" class="table table-hover"></table></div></div></div></div>'),s="<tr>",s+="<th>#</th>",s+="<th>VISITOR</th>",s+="<th>LAST ACTIVITY</th>",s+="<th>STATUS</th>",s+="<th>VIEWING</th>",s+="</tr>",document.getElementById("visitors_table").innerHTML=s;for(e in i.tracked_users)i.tracked_users.hasOwnProperty(e)&&(t='<tr onclick="inviteToChat('+i.tracked_users[e].user_id+');">',t+="<td>"+i.tracked_users[e].user_id+"</td>",t+='<td><span style="float:left">Guest</span>',t+='<span style="float:right">',t+=""!=i.tracked_users[e].country_name&&"Null"!=i.tracked_users[e].country_name&&"Undefined"!=i.tracked_users[e].country_name?'<img class="tip_tip" title="'+i.tracked_users[e].country_name+'" style="margin-top:-2px" src="'+dataServer+"/img/countries/"+i.tracked_users[e].country_code.toLocaleLowerCase()+'.png"/>':'<img class="tip_tip" title="" style="margin-top:-2px" src="'+dataServer+'/img/countries/earth.png"/>',t+='<a class="tip_tip" title="'+i.tracked_users[e].os+", "+i.tracked_users[e].browser+'"><i class="fa fa-desktop" style="margin-left:10px; font-size:11px"></i></a>',t+="</span>",t+="</td>",t+="<td>"+i.tracked_users[e].relative_date+"</td>",t+='<td><span class="label label-primary">Visitor</span></td>',t+="<td>"+i.tracked_users[e].current_url+"</td>",t+="</tr>",$("#visitors_table").append(t),$(function(){$(".tip_tip").tipTip()}),$(function(){$(".tip_tip").tipTip({maxWidth:"auto",edgeOffset:10})}))}if(0==i.all_users.length)$("#chat-requests-container").html('<div style="text-align: center">NO CHAT REQUESTS</div>');else{$("#chat-requests-container").html('<div class="row"><div class="col-xs-12"><div class="panel"><header class="panel-heading">Chat Requests</header><div class="panel-body table-responsive"><div class="box-tools m-b-15"><div class="input-group"><input type="text" name="table_search" class="form-control input-sm pull-right" style="width: 150px;" placeholder="Search"/><div class="input-group-btn"><button class="btn btn-sm btn-default"><i class="fa fa-search"></i></button></div></div></div><table id="requests_table" class="table table-hover"></table></div></div></div></div>'),s="<tr>",s+="<th>#</th>",s+="<th>VISITOR</th>",s+="<th>STARTED</th>",s+="<th>STATUS</th>",s+="<th>VIEWING</th>",s+="</tr>",document.getElementById("requests_table").innerHTML=s;for(e in i.all_users)i.all_users.hasOwnProperty(e)&&(t='<tr onclick="loadChat('+i.all_users[e].request_id+');">',t+="<td>"+i.all_users[e].user_id+"</td>",t+='<td><span style="float:left">'+i.all_users[e].name+"</span>",t+='<span style="float:right">',t+=""!=i.all_users[e].country_name&&null!=i.all_users[e].country_name&&"Null"!=i.all_users[e].country_name&&void 0!=i.all_users[e].country_name&&"Undefined"!=i.all_users[e].country_name?'<img class="tip_tip" title="'+i.all_users[e].country_name+'" style="margin-top:-2px" src="'+dataServer+"/img/countries/"+i.all_users[e].country_code.toLocaleLowerCase()+'.png"/>':'<img class="tip_tip" title="" style="margin-top:-2px" src="'+dataServer+'/img/countries/earth.png"/>',t+='<a class="tip_tip" title="'+i.all_users[e].os+", "+i.all_users[e].browser+'"><i class="fa fa-desktop" style="margin-left:10px; font-size:11px"></i></a>',t+="</span>",t+="</td>",t+="<td>"+i.all_users[e].relative_date+"</td>",t+=0==i.all_users[e].in_chat?'<td><span class="label label-warning">Chat request</span></td>':'<td><span class="label label-success">Chat in progress</span></td>',t+="<td>"+i.all_users[e].uri+"</td>",t+="</tr>",$("#requests_table").append(t),$(function(){$(".tip_tip").tipTip()}),$(function(){$(".tip_tip").tipTip({maxWidth:"auto",edgeOffset:10})}))}}function loadChat(t){validNavigation=!0,window.location.href=applicationPath+"visitors/chat?request="+t}function inviteToChat(t){confirm("Do you want to invite this user to chat?")}updateVisitors(),setInterval(updateVisitors,2500);